\section{Definitions}

Formalization of a Tetris game and definition of the problem. We will follow the definition from \cite{TIH}.


\begin{definition}
  A \emph{board} B is an $n$ by $m$ grid. Each cell $\cell$, $i = 1\dots n$, $j = 1\dots m$ is \emph{filled} or \emph{unfilled}.
\end{definition}

The board will be indexed from bottom to top and from left to right. The cell $\cell[1][1]$ is in the bottom left of the board and $\cell[n][m]$ is the top right-most cell. \\

The following definitions will define the pieces and how they interact with the board.

\begin{definition}
  A \emph{piece type} $t$ is one of the following:  \ALL. 
\end{definition}

\begin{definition}
 A \emph{piece state} in a board $B$ is a tuple $ P = \piece$ where:
  \begin{itemize}
    \item $t$ is a piece type
    \item $\theta$ is the \emph{orientation}, the number of degrees clockwise from the original piece. $ \theta \in \lbrace 0^\circ, 90^\circ, 180^\circ, 270^\circ \rbrace$
    \item $\cell$ is the \emph{position} of the piece in of $B$
    \item  $f$ indicates if the piece is \emph{fixed} or \emph{unfixed} in B.
  \end{itemize}

  We will refer to a piece sate as \emph{piece}.
   
\end{definition}

\begin{definition}
  Given a piece type $t$ and a board $B$, the piece $P_0 = \piece[t][0^\circ][n][\lfloor m / 2 \rfloor][\text{unfixed}]$ is the \emph{initial state} of the pice type of $t$ in the board $B$.
\end{definition}


The idea is to have only one active piece in a Tetris game. Only the piece that is moving has a state. When a piece reaches the \emph{fixed} state, is automatically merged with the board. Then the next piece starts in its initial state. In order to define how a piece moves thought the board, we need to define some \emph{moves} for changing the piece state.

\begin{definition}
  A \emph{rotaion model}
\end{definition}

VAL LA PENA DEFINIR EL CONJUT DE TOTS ELS ESTATS POSSIBLES?

\begin{definition}
  A \emph{move} is a computable function that changes the state of a piece under certain conditions. The following moves can be applied to a piece $P = \piece[t][\theta][i][j][\text{unfixed}]$. 
  \begin{itemize}
    \item \emph{clockwise rotation}
    \item \emph{counterclockwise rotation}
    \item \emph{slide to the left}
    \item \emph{slide to the right}
    \item \emph{drop by one row}
    \item \emph{fix}
  \end{itemize}
  If all the conditions are satisfied the move is said to be \emph{legal}, if any of the conditions are not satisfied the move is \emph{ilegal}. 
\end{definition}

Let's now define the \emph{trajectory} of a piece type in a Tetris game. Intuitively the trajectory starts when the piece is given to the player  and ends when he fixes the piece in the board.


\begin{definition}
 Let $B$ be a board and $t$ a piece type. Let $P_0$ be the initial state of the piece type $t$. Then a sequence of $k$ moves $\sigma = (m_1, ..., m_k)$ to the piece state after $i$ moves is a \emph{trajectory} if:

 \begin{itemize}
  \item the move $m_i$ over $P_i$ is a valid move for all $i = 1 \dots k$
  \item and $m_k$ is a \emph{fix} move.
 \end{itemize}
 
 Where $P_{i+1} = m_i(P_i)$ is the piece stat in $B$ after $i$ moves.
\end{definition}

After a piece trajectory a new board can be defined.

\begin{definition}
  Given a board $B$, a piece $p$ and some trajectory $t$, PRODUCTEd a new board $B'$ :wa:wa
\end{definition}
